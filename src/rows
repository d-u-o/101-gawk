#!/usr/bin/env ./gold
# vim: filetype=awk: ts=2 sw=2 sts=2 expandtab:cindent:formatoptions+=cro 

@include "config"

BEGIN { FS = OFS = ","
        split( AU.ch.less AU.ch.more AU.ch.klass \
               AU.ch.num AU.ch.sym,  All, "") }

function Slots(i,   j) {
  new(i)
  for(j in All) has(i, All[j]) }

{  gsub(/[ \t\r]*/, "", txt)    # no whitespce:
   gsub(/#["*"]$/,  "", txt)  } # no comments
NR==1 { Slots(Header)
        for(i=1;i<=NF;i++)  {
          if ($i !~ AU.ch.skip) {
            for(j in All) {
              if ($i ~ All[j]) {
                print "ij ",j, $i, All[j]
                Header[ All[j] ][i] 
              }}}}
        o(Header,22)
      }
0      { print ""
        for(j in All) {
          printf j 
          for(i in Header[j]) printf OFS i 
          print "" }}
